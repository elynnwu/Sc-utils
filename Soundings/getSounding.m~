function [p z tp td RH w winddir windspeed theta theta_e theta_v]=getSounding(date_i)
    
    %% Load yearly netcdf file (obtained from https://ruc.noaa.gov/raobs/ )
    raob_filename=['raw/raob_soundings_',num2str(year(date_i)),'.cdf'];
    raob_dates=datetime(1970,1,1,0,0,0)+ncread(raob_filename,'synTime')/3600/24;
    i_star=find(raob_dates==date_i);
    
    htSigT=ncread(filename,'htSigT',[1 i_star],[250 1]); htSigT(htSigT>1e30)=[]; f=htSigT<3000; htSigT=htSigT(f);
    tpSigT=ncread(filename,'htSigT',[1 i_star],[250 1]); tpSigT(tpSigT>1e30)=[]; tpSigT=tpSigT(f);
    tSigT=ncread(filename,'htSigT',[1 i_star],[250 1]); tpSigT(tpSigT>1e30)=[]; tpSigT=tpSigT(f);
    
    
    htMan=ncread(filename,'htMan',[1 i_star],[22 1]); htMan(htMan>1e30)=[];
    htSigW=ncread(filename,'htSigW',[1 i_star],[150 1]); htSigW(htSigW>1e30)=[];
    htTrop=ncread(filename,'htTrop',[1 i_star],[4 1]); htTrop(htTrop>1e30)=[];
    
    
    
    
    
end